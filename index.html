<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MHPP Leaderboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.3.3/dist/echarts.min.js"></script>
    <link rel="icon" href="https://images.emojiterra.com/google/noto-emoji/unicode-15/color/1024px/1f9d1-1f4bb.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@100;400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: "JetBrains Mono", monospace;
            background-color: #FFFFFF;
            color: #000000;
        }

        #content {
            width: 75%;
        }

        th,
        td {
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        #notes {
            font-size: 1em;
        }

        #notes h3 {
            margin-top: 1em;
            font-size: 2em;
            text-align: center;
        }

        #notes li {
            font-size: 1.2em;
            font-weight: 300;
            margin: 1em;
        }

        .form-select {
            font-size: 1em;
        }

        @media screen and (max-width: 1400px) {
            body {
                font-size: 1.6vw;
            }

            #content {
                width: 100%;
            }

            h1 {
                font-size: 2em;
            }

            h2 {
                font-size: 1.6em;
            }

            h3 {
                font-size: 1.2em;
            }

            table {
                font-size: small;
            }
        }
    </style>
</head>
<body>
<div id="content" class="container-fluid d-flex flex-column align-items-center gap-3">
    <h1 class="text-nowrap mt-5">üèÜ MHPP Leaderboard üèÜ</h1>
    <h2 class="fw-light text-nowrap">
        <small id="warning" style="font-size: medium;">MHPP Evaluates AI Coders Performance against Diverse Code
            Generation Challenges<br></small>
    </h2>
    <div class="d-flex flex-row justify-content-center gap-3">
        <a href="https://github.com/SparksofAGI/MHPP">
            <img src="https://img.shields.io/badge/github-%23121011.svg?style=for-the-badge&logo=github&logoColor=white"
                 alt="github" class="img-fluid">
        </a>
    </div>
    <div class="d-flex flex-row justify-content-center gap-1 mt-3 mb-0">
        <p> &#129303; </p>
        <a href="https://github.com/SparksofAGI/MHPP/issues/new?assignees=&labels=model+eval&projects=&template=model_eval_request.yml&title=%F0%9F%92%A1+%5BREQUEST%5D+-+%3CMODEL_NAME%3E">
            File a request
        </a>
        <p> to add your models on our leaderboard!</p>
    </div>
    <div class="container-fluid d-flex flex-row flex-nowrap">
        <div class="container-fluid d-flex flex-column align-items-center">
            <label for="plused" class="text-success mb-3">‚ö°MHPP‚ö°</label>
            <table id="plused"
                   class="table table-responsive table-striped table-bordered flex-shrink-1 border border-success border-3"></table>
        </div>
    </div>
    <div id="notes">
        <h3>üìù Notes</h3>
        <p class="inline-block mt-3">
        <ol>
            <li>
                Models are ranked based on their pass@1 scores using greedy decoding. For the sampling results, we set
                the temperature to 0.7 and sampled 100 times.
                We recommend using 1024 tokens as the context length, considering the length of problems and potential
                responses.
            </li>
            <li>In the table, positions marked with a '-' indicate that the data was not collected due to limited
                resources or budget constraints.
            </li>
        </ol>
        </p>
    </div>
    <div>
        <h3>ü§ó Acknowledgement and More Leaderboards</h3>
        We greatly thank the authors of the <a href="https://github.com/evalplus/evalplus.github.io">EvalPlus
        Leaderboard</a> for allowing us to borrow their leaderboard code! In addition to MHPP leaderboards, it is
        recommended to comprehensively understand LLM coding ability through a diverse set of benchmarks and
        leaderboards, such as:
        <p class="inline-block mt-3">
        <ol>
            <li><a href="https://huggingface.co/spaces/bigcode/bigcode-models-leaderboard">Big Code Models
                Leaderboard</a></li>
            <li><a href="https://evalplus.github.io/">EvalPlus Leaderboard</a></li>
            <li><a href="https://huggingface.co/spaces/bigcode/bigcodebench-leaderboard">BigCodeBench Leaderboard</a>
            </li>
            <li><a href="https://www.swebench.com">SWE-bench Leaderboard</a></li>
            <li><a href="https://crux-eval.github.io/leaderboard.html">CRUXEval Leaderboard</a></li>
            <li><a href="https://huggingface.co/spaces/lmsys/chatbot-arena-leaderboard">Chatbot Arena Leaderboard</a>
            </li>
        </ol>
        </p>
    </div>
</div>

<script>
    const plusedTable = document.getElementById('plused');

    const theaders = [
        'Model',
        'Pass@1 Greedy',
        'Pass@1 Sampling',
        'Pass@5 Sampling',
    ];

    function clearTable() {
        plusedTable.innerHTML = '';
    }

    function clearChart() {
        option.xAxis.data = [];
        option.series[0].data = [];
        option.series[1].data = [];
        option.series[0].markLine.data = [];
        option.series[1].markLine.data = [];
    }

    function updateTable(table, url, displayColumns, sortColumn) {
        clearTable();
        Papa.parse(url, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: function (results) {
                results.data.sort(function (a, b) {
                    return parseFloat(b[sortColumn]) - parseFloat(a[sortColumn]);
                });
                displayTable(table, results.data, displayColumns);
            }
        });
    }

    function displayTable(table, data, displayColumns) {
        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');
        // add rank
        const th = document.createElement('th');
        th.textContent = '#';
        headerRow.appendChild(th);
        // headers
        theaders.forEach(function (header) {
            const th = document.createElement('th');
            th.textContent = header;
            headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        table.appendChild(thead);

        const tbody = document.createElement('tbody');
        // add rank
        let rank = 1;
        data.forEach(function (row) {
            const dataRow = document.createElement('tr');
            const rankCell = document.createElement('td');
            rankCell.textContent = rank;
            dataRow.appendChild(rankCell);

            const modelCell = document.createElement('td');
            if (rank === 1) {
                modelCell.textContent = 'ü•á ';
            } else if (rank === 2) {
                modelCell.textContent = 'ü•à ';
            } else if (rank === 3) {
                modelCell.textContent = 'ü•â ';
            } else {
                modelCell.textContent = '';
            }
            rank++;
            const modelLink = document.createElement('a');
            modelLink.href = row['link'];
            modelLink.textContent = row['Model'];
            modelLink.classList.add('link-underline-primary');
            modelLink.classList.add('text-nowrap');
            modelCell.appendChild(modelLink);
            modelCell.classList.add('d-flex');
            modelCell.classList.add('flex-nowrap');

            const prompted = row['prompted'];
            if (prompted === 'TRUE') {
                // add a symbol to indicate the model is prompted
                const promptedSymbol = document.createElement('span');
                promptedSymbol.textContent = 'üóíÔ∏è';
                modelCell.appendChild(promptedSymbol);
            }

            const detailSymbol = document.createElement('span');
            detailSymbol.style.cursor = 'pointer';
            detailSymbol.textContent = 'üîª';
            detailSymbol.onclick = function (event) {
                toggleDetails(event, row['Model']);
            };
            detailSymbol.style.display = 'inline-block';
            detailSymbol.style.width = '100%';
            detailSymbol.style.textAlign = 'right';
            modelCell.appendChild(detailSymbol);
            dataRow.appendChild(modelCell);

            for (let i = 0; i < displayColumns.length; i++) {
                const passCell = document.createElement('td');
                passCell.textContent = row[displayColumns[i]];
                dataRow.appendChild(passCell);
            }
            tbody.appendChild(dataRow);
        });
        table.appendChild(tbody);
    }

    function toggleDetails(event, model) {
        const currentRow = event.target.closest('tr');
        let detailRow = document.getElementById(`detail-row-${model}`);

        if (detailRow) {
            // If details row already exists, remove it
            detailRow.remove();
        } else {
            // Otherwise, add the details row
            detailRow = document.createElement('tr');
            detailRow.id = `detail-row-${model}`;
            const detailCell = document.createElement('td');
            detailCell.colSpan = theaders.length + 1;
            detailCell.innerHTML = `
      <div style="padding: 0px; background-color: white; font-size: 13px;">
      <table style="width: 100%; border-collapse: collapse; border: 0px solid green;">
        <thead>
          <tr>
            <th style="padding: 8px; border: 1px solid green;">Category</th>
            <th style="padding: 8px; border: 1px solid green;">Codesense</th>
            <th style="padding: 8px; border: 1px solid green;">Commonsense</th>
            <th style="padding: 8px; border: 1px solid green;">Complex</th>
            <th style="padding: 8px; border: 1px solid green;">Cornercase</th>
            <th style="padding: 8px; border: 1px solid green;">Distraction</th>
            <th style="padding: 8px; border: 1px solid green;">Redefinition</th>
            <th style="padding: 8px; border: 1px solid green;">Shortcut</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th style="padding: 8px; border: 1px solid green;">pass@1</th>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Codesense pass@1']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Commonsense pass@1']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Complex pass@1']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Cornercase pass@1']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Distraction pass@1']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Redefinition pass@1']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Shortcut pass@1']}</td>
          </tr>
          <tr>
            <th style="padding: 8px; border: 1px solid green;">pass@5</th>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Codesense pass@5']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Commonsense pass@5']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Complex pass@5']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Cornercase pass@5']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Distraction pass@5']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Redefinition pass@5']}</td>
            <td style="text-align: right; padding: 8px; border: 1px solid green;">${data[data.findIndex(row => row.Model === model)]['Shortcut pass@5']}</td>
          </tr>
        </tbody>
      </table>
      </div>
        `;
            detailRow.appendChild(detailCell);
            currentRow.after(detailRow);
        }
    }

    const currentUrl = 'new_mhpp.csv';
    let data; // To store the data globally
    Papa.parse(currentUrl, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function (results) {
            data = results.data;
            updateTable(plusedTable, currentUrl, [
                'Greedy',
                'pass@1',
                'pass@5',
            ], 'Greedy');
        }
    });

    window.addEventListener("resize", () => {
        if (typeof myChart !== 'undefined') {
            myChart.resize();
        }
    });
</script>
</body>
</html>
